# -*- coding: utf-8 -*-
"""Dataset.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1hcGzMnvs81oIS1mAzMkT40K8dptdOlRR
"""



"""Enlace a archivo guardado en drive"""

from google.colab import drive
drive.mount('/content/drive')

import pandas as pd
import numpy as np

"""Carga del dataset"""

datos = pd.read_csv('/content/drive/MyDrive/datasets/wine.csv',index_col=0)
datos.head(5)



"""Informacion dataset"""

datos.shape

datos.info()

datos.describe()

datos.price.describe()

datos.index

datos.columns

columnas = datos.columns
columnas

type(columnas)

datos.tail(3)



"""Obtencion de valores"""

datos.country

datos['province']

datos.province

datos['country'][3]

"""Obtener los datos por indice - iloc"""

datos.iloc[:,1]

datos.iloc[2:5,2:6]

datos.iloc[[2,4,10],0]

datos.iloc[-6:]

datos.loc[4,'country']

datos.loc[1:5,['country','points']]

#datos=datos.set_index(['country'])
datos.head(3)

"""Filtrar y seleccionar"""

datos.country=='US'

datos.loc[datos.country=='US']

datos_filtrados = datos[(datos.points>90)&(datos.country=='US')]



datos_filtrados.head(5)

datos.loc[datos.country.isin(['US','France'])]

datos.loc[datos.price.notnull()]

datos.loc[datos.price.isnull()]

"""Asignar valores columna nueva"""

datos['NuevaColumna']=datos['price']*3
datos[['price','NuevaColumna']]

datos.price.mean()

"""Operaciones con nulos"""

columnas_nulos = datos.columns[datos.isnull().any()]
datos[columnas_nulos].isnull().sum()

datos.isnull().sum()

datos.isnull().any()

datos_sin_nulos = datos.dropna(how='any')

datos_sin_nulos.isnull().sum()

datos.shape

datos_sin_nulos.shape

"""Valores unicos"""

datos.country.unique()

datos.country.value_counts()

media_puntos = datos.points.mean()
mediana_puntos = datos.points.median()

media_puntos

mediana_puntos

datos.points.map(lambda punto:punto - media_puntos)

"""Agrupaciones"""

agrupados=datos.groupby('country').points.count()
agrupados

agrupados=datos.groupby('country').price.min()
agrupados

datos.groupby(['country','points']).price.agg([min,max])

datos.sort_values(by='points',ascending=True)

datos.price.dtype

datos.dtypes

datos.points = datos.points.astype('float64')
datos.points.dtype

"""Reemplazar"""

datos.country=datos.country.replace('US','EEUU')
datos.head()

datos.country.fillna('Sin dato')

datos.rename(columns={'points':'puntos','price':'precio'})

datos.rename(index={1:'segundaFila',2:'terceraFila'})

datos.rename_axis('vinos',axis='rows').rename_axis('campos',axis='columns')

"""Combinar dataframes"""

datosUSA=datos[datos.country=='EEUU']
datosFrancia=datos[datos.country=='France']

datosUSA.head()

datosFrancia.head()

datosUnidos = pd.concat([datosUSA,datosFrancia])
datosUnidos.head()

datosUnidos.tail()

























































